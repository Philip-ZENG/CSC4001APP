{"ast":null,"code":"import managementConsole from '../components/ActivityManagement/ManagementConsole.vue';\n\nconst axios = require('axios').default;\n\nconst ACTIVITY_INFO_URL = 'http://localhost:4000/getActivityInfo';\nconst USER_ROLE = 'http://localhost:4000/getUserRole';\nconst DELETE_MEMBER = 'http://localhost:4000/quitActivity';\nconst CHANGE_MANAGER = 'http://localhost:4000/changeManager';\nconst TERMINATE_ACTIVITY = 'http://localhost:4000/terminateActivity';\nconst MEMBER_LIST = 'http://localhost:4000/getMemberList';\nexport default {\n  components: {\n    'management-console': managementConsole\n  },\n\n  data() {\n    return {\n      activity_id: null,\n      // Use array here because if set to null, the data cannot be pass through\n      user_id: [],\n      user_role: [],\n      ACTIVITY_INFO: [{\n        activity_id: null,\n        description: '',\n        heat: null,\n        location: '',\n        max_capacity: null,\n        quota_left: null,\n        time: '',\n        title: '',\n        type: ''\n      }],\n      MEMBER_ID_LIST: [],\n      // The list of user_ids who take part in the activity\n      MEMBER_INFO: [] // Information of all the members\n\n    };\n  },\n\n  provide() {\n    return {\n      // Data\n      userId: this.user_id,\n      userRole: this.user_role,\n      activityInfo: this.ACTIVITY_INFO,\n      memberIdList: this.MEMBER_ID_LIST,\n      memberInfo: this.MEMBER_INFO,\n      // Methods\n      deleteMember: this.deleteMember,\n      changeManager: this.changeManager,\n      terminateActivity: this.terminateActivity\n    };\n  },\n\n  methods: {\n    /**\n     * @description\n     * Return activity info of a specific activity with the provided activity_id\n     */\n    getActivityInfo(callback) {\n      const that = this;\n      axios.post(ACTIVITY_INFO_URL, {\n        activity_id: this.activity_id\n      }).then(response => {\n        that.ACTIVITY_INFO.push(response.data);\n        return callback();\n      });\n    },\n\n    /**\n     * @description\n     * Return the role of a user with the provided activity_id and user_id\n     */\n    getUserRole(callback) {\n      axios.post(USER_ROLE, {\n        activity_id: this.activity_id,\n        user_id: this.user_id\n      }).then(response => {\n        this.user_role.push(response.data.role);\n        return callback();\n      });\n    },\n\n    renderPage() {\n      const self = this;\n\n      const myPromise1 = function () {\n        return new Promise(resolve => {\n          self.getActivityInfo(() => {\n            resolve();\n          });\n        });\n      };\n\n      const myPromise2 = function () {\n        return new Promise(resolve => {\n          self.getUserRole(() => {\n            resolve();\n          });\n        });\n      };\n\n      myPromise1().then(() => {\n        console.log(this.ACTIVITY_INFO);\n      });\n    },\n\n    /**\n     * @description\n     * Quit from the activity with provided activity_id and user_id\n     * If the user is a manager, we need to make sure there is at least another manager before\n     * he can execute this action\n     */\n    deleteMember(userId) {\n      axios.post(DELETE_MEMBER, {\n        activity_id: this.activity_id,\n        user_id: userId\n      });\n    },\n\n    /**\n     * @description\n     * Transfer the authority of activity manager to other member with provided new_manager_id\n     */\n    changeManager(newManagerId) {\n      axios.post(CHANGE_MANAGER, {\n        activity_id: this.activity_id,\n        new_manager_id: newManagerId,\n        old_manager_id: this.userId\n      });\n    },\n\n    /**\n     * @description\n     * Terminate the whole activity, can only be triggered by activity manager\n     */\n    terminateActivity() {\n      axios.post(TERMINATE_ACTIVITY, {\n        activity_id: this.activity_id\n      });\n    },\n\n    /**\n     * @description\n     * Get the list of users who has the take part in the activity with provided activity_id\n     */\n    getMemberList() {\n      axios.post(MEMBER_LIST, {\n        activity_id: this.activity_id\n      });\n    }\n\n  },\n\n  mounted() {\n    this.getActivityInfo();\n    this.getUserRole();\n  },\n\n  created() {\n    // get the route parameter 'id' from router\n    this.activity_id = this.$route.params.activity_id;\n    this.user_id.push(this.$route.params.user_id);\n  }\n\n};","map":{"version":3,"mappings":"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","names":["managementConsole","axios","require","default","ACTIVITY_INFO_URL","USER_ROLE","DELETE_MEMBER","CHANGE_MANAGER","TERMINATE_ACTIVITY","MEMBER_LIST","components","data","activity_id","user_id","user_role","ACTIVITY_INFO","description","heat","location","max_capacity","quota_left","time","title","type","MEMBER_ID_LIST","MEMBER_INFO","provide","userId","userRole","activityInfo","memberIdList","memberInfo","deleteMember","changeManager","terminateActivity","methods","getActivityInfo","callback","that","post","then","response","push","getUserRole","role","renderPage","self","myPromise1","Promise","resolve","myPromise2","console","log","newManagerId","new_manager_id","old_manager_id","getMemberList","mounted","created","$route","params"],"sourceRoot":"","sources":["D:\\MySQL\\pickup\\client\\src\\views\\ActivityManagementView.vue"],"sourcesContent":["<template>\n  <section>\n    <div class=\"home\">\n      <h2>The activity id is {{ activity_id }}</h2>\n      <h2>The user id is {{ user_id }}</h2>\n    </div>\n    <management-console></management-console>\n  </section>\n</template>\n\n<script>\nimport managementConsole from '../components/ActivityManagement/ManagementConsole.vue';\n\nconst axios = require('axios').default;\n\nconst ACTIVITY_INFO_URL = 'http://localhost:4000/getActivityInfo';\nconst USER_ROLE = 'http://localhost:4000/getUserRole';\nconst DELETE_MEMBER = 'http://localhost:4000/quitActivity';\nconst CHANGE_MANAGER = 'http://localhost:4000/changeManager';\nconst TERMINATE_ACTIVITY = 'http://localhost:4000/terminateActivity';\nconst MEMBER_LIST = 'http://localhost:4000/getMemberList';\n\nexport default {\n  components: {\n    'management-console': managementConsole,\n  },\n  data() {\n    return {\n      activity_id: null,\n      // Use array here because if set to null, the data cannot be pass through\n      user_id: [],\n      user_role: [],\n      ACTIVITY_INFO: [\n        {\n          activity_id: null,\n          description: '',\n          heat: null,\n          location: '',\n          max_capacity: null,\n          quota_left: null,\n          time: '',\n          title: '',\n          type: '',\n        },\n      ],\n      MEMBER_ID_LIST: [], // The list of user_ids who take part in the activity\n      MEMBER_INFO: [], // Information of all the members\n    };\n  },\n  provide() {\n    return {\n      // Data\n      userId: this.user_id,\n      userRole: this.user_role,\n      activityInfo: this.ACTIVITY_INFO,\n      memberIdList: this.MEMBER_ID_LIST,\n      memberInfo: this.MEMBER_INFO,\n      // Methods\n      deleteMember: this.deleteMember,\n      changeManager: this.changeManager,\n      terminateActivity: this.terminateActivity,\n    };\n  },\n  methods: {\n    /**\n     * @description\n     * Return activity info of a specific activity with the provided activity_id\n     */\n    getActivityInfo(callback) {\n      const that = this;\n      axios\n        .post(ACTIVITY_INFO_URL, { activity_id: this.activity_id })\n        .then((response) => {\n          that.ACTIVITY_INFO.push(response.data);\n          return callback();\n      });\n    },\n    /**\n     * @description\n     * Return the role of a user with the provided activity_id and user_id\n     */\n    getUserRole(callback) {\n      axios\n        .post(USER_ROLE, { activity_id: this.activity_id, user_id: this.user_id })\n        .then((response) => {\n          this.user_role.push(response.data.role);\n          return callback();\n        });\n    },\n    renderPage() {\n      const self = this;\n      const myPromise1 = function () {\n        return new Promise((resolve) => {\n          self.getActivityInfo(() => {\n            resolve();\n          });\n        });\n      };\n      const myPromise2 = function () {\n        return new Promise((resolve) => {\n          self.getUserRole(() => {\n            resolve();\n          });\n        });\n      };\n\n      myPromise1()\n        .then(() => {\n          console.log(this.ACTIVITY_INFO);\n        });\n    },\n    /**\n     * @description\n     * Quit from the activity with provided activity_id and user_id\n     * If the user is a manager, we need to make sure there is at least another manager before\n     * he can execute this action\n     */\n    deleteMember(userId) {\n      axios.post(DELETE_MEMBER, { activity_id: this.activity_id, user_id: userId });\n    },\n    /**\n     * @description\n     * Transfer the authority of activity manager to other member with provided new_manager_id\n     */\n    changeManager(newManagerId) {\n      axios.post(CHANGE_MANAGER, {\n        activity_id: this.activity_id,\n        new_manager_id: newManagerId,\n        old_manager_id: this.userId,\n      });\n    },\n    /**\n     * @description\n     * Terminate the whole activity, can only be triggered by activity manager\n     */\n    terminateActivity() {\n      axios.post(TERMINATE_ACTIVITY, { activity_id: this.activity_id });\n    },\n    /**\n     * @description\n     * Get the list of users who has the take part in the activity with provided activity_id\n     */\n    getMemberList() {\n      axios.post(MEMBER_LIST, { activity_id: this.activity_id });\n    },\n  },\n  mounted() {\n    this.getActivityInfo();\n    this.getUserRole();\n  },\n  created() {\n    // get the route parameter 'id' from router\n    this.activity_id = this.$route.params.activity_id;\n    this.user_id.push(this.$route.params.user_id);\n  },\n};\n</script>\n"]},"metadata":{},"sourceType":"module"}